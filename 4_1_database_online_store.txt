1. Провести аналитику по трем ценовым категориям (до 600 руб, от 600 руб до 700 руб, свыше 700 руб) и вывести среднюю цену  книги, общую стоимость остатков книг в этой ценовой позиции и количество позиций. Среднюю цену и стоимость округлить до двух знаков после запятой. Информацию отсортировать по возрастанию нижней границы 
ценовой категории.

Ответ:

SELECT beg_range, end_range, 
ROUND (AVG(price), 2) AS Средняя_цена, 
ROUND (SUM(amount * price), 2) AS Стоимость, 
COUNT(*) AS Количество
FROM stat JOIN book
ON price >= beg_range AND price < end_range
GROUP BY beg_range, end_range
ORDER BY beg_range;

*****

2. Вывести всю информацию из таблицы book, упорядоченную по возрастанию длины названия книги.

Ответ:

SELECT book_id, title, author, price, amount
FROM book
ORDER BY length(title) ASC;

*****

3. Удалить из таблиц book и supplyкниги, цены которых заканчиваются на 99 копеек. Например, книга с ценой 670.99 должна быть удалена.

Ответ:

DELETE FROM book
WHERE price LIKE '%.99';

DELETE FROM supply
WHERE price LIKE '%.99';

SELECT * FROM book;
SELECT * FROM supply;

*****

4. Снизить цены книг, цена которых больше 600 рублей, на 20%. Вывести информацию о книгах, скидку (столбец sale_20) и цену книги со скидкой (price_sale).  Результаты округлить до двух знаков после запятой. Для тех книг, на которые скидка не действует, в последних двух столбцах вывести символ  "-".  Отсортировать информацию сначала по фамилии автора, а потом по названию книги.

Ответ:

SELECT author, title, price, amount,
IF(price > 600, ROUND(price * 0.2, 2),  '-') AS sale_20,
IF(price > 600, ROUND(price - price * 0.2, 2), '-') AS price_sale
FROM book
ORDER BY author, title;

*****

5. Вывести авторов и суммарную стоимость их книг, если хотя бы одна их книга имеет цену выше средней по складу. Средняя цена рассчитывается как простое среднее, с помощью avg(). Информацию отсортировать по убыванию суммарной стоимости.

Ответ:

SELECT author, SUM(price * amount) AS Стоимость
FROM book
GROUP BY author
HAVING AVG(price) > ANY(SELECT price FROM book)
ORDER BY Стоимость DESC;

*****

6. Вывести автора, название, количество, цену (Розничная_цена). Для тех книг количество которых больше или равно 10, отобразить оптовую скидку 15% (Скидка), округлить до двух знаков после запятой и вывести оптовую цену с учетом скидки -15% (Оптовая_цена). Все атрибуты перевести на русский язык. Отсортировать по автору и названию книги.

Ответ:

SELECT author AS Автор, title AS Название_книги, amount AS Количество, price AS Розничная_цена, 
IF(amount >= 10, 15, 0) AS Скидка, 
ROUND(IF(amount >= 10, price - price * 0.15, price), 2) AS Оптовая_цена
FROM book
ORDER BY 1, 2;

*****

7. Вывести авторов, у которых есть книги со стоимостью более 500 и количеством более 1 шт на складе. Учитывать книги только тех авторов, у которых не менее 2-х произведений на складе. Вывести автора, количество различных произведений автора, минимальную цену и количество книг на складе. Информацию отсортировать по фамилии автора в алфавитном порядке.

Ответ:

SELECT author, COUNT(author) AS Количество_произведений, MIN(price) AS Минимальная_цена, SUM(amount) AS Число_книг
FROM book
WHERE amount > 1
GROUP BY author
HAVING COUNT(author) > 1
ORDER BY 1;

*****