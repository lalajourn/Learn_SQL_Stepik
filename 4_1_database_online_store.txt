1. Провести аналитику по трем ценовым категориям (до 600 руб, от 600 руб до 700 руб, свыше 700 руб) и вывести среднюю цену  книги, общую стоимость остатков книг в этой ценовой позиции и количество позиций. Среднюю цену и стоимость округлить до двух знаков после запятой. Информацию отсортировать по возрастанию нижней границы 
ценовой категории.

Ответ:

SELECT beg_range, end_range, 
ROUND (AVG(price), 2) AS Средняя_цена, 
ROUND (SUM(amount * price), 2) AS Стоимость, 
COUNT(*) AS Количество
FROM stat JOIN book
ON price >= beg_range AND price < end_range
GROUP BY beg_range, end_range
ORDER BY beg_range;

*****

2. Вывести всю информацию из таблицы book, упорядоченную по возрастанию длины названия книги.

Ответ:

SELECT book_id, title, author, price, amount
FROM book
ORDER BY length(title) ASC;

*****

3. Удалить из таблиц book и supplyкниги, цены которых заканчиваются на 99 копеек. Например, книга с ценой 670.99 должна быть удалена.

Ответ:

DELETE FROM book
WHERE price LIKE '%.99';

DELETE FROM supply
WHERE price LIKE '%.99';

SELECT * FROM book;
SELECT * FROM supply;

*****

4. Снизить цены книг, цена которых больше 600 рублей, на 20%. Вывести информацию о книгах, скидку (столбец sale_20) и цену книги со скидкой (price_sale).  Результаты округлить до двух знаков после запятой. Для тех книг, на которые скидка не действует, в последних двух столбцах вывести символ  "-".  Отсортировать информацию сначала по фамилии автора, а потом по названию книги.

Ответ:

SELECT author, title, price, amount,
IF(price > 600, ROUND(price * 0.2, 2),  '-') AS sale_20,
IF(price > 600, ROUND(price - price * 0.2, 2), '-') AS price_sale
FROM book
ORDER BY author, title;

*****

5. Вывести авторов и суммарную стоимость их книг, если хотя бы одна их книга имеет цену выше средней по складу. Средняя цена рассчитывается как простое среднее, с помощью avg(). Информацию отсортировать по убыванию суммарной стоимости.

Ответ:

